<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ぼぼマップ | JK1JAD</title>
<style>
  /* ===== JAD風・最低限 ===== */
  :root{ --ink:#0b132b; --mut:#94a3b8; --y:#d6c420; }
  html,body{ margin:0; background:var(--ink); color:#e5e7eb; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; }
  .wrap{ max-width:1024px; margin:0 auto; padding:24px 16px 40px; }
  h1{ font-size:1.4rem; margin:0 0 .25rem; }
  .lead{ color:var(--mut); margin:0 0 1rem; font-size:.95rem; }
  .stage{ background:#0f172a; border:1px solid #1f2937; border-radius:16px; padding:12px; }
  .stage svg{ width:100%; height:auto; display:block; }
  .pill{ display:inline-block; font-size:.78rem; color:#9ca3af; border:1px solid #334155; padding:.1rem .5rem; border-radius:999px; margin:.5rem 0 1rem; }
  .note{ color:#9ca3af; font-size:.85rem; margin-top:.75rem; }

  /* ===== 地図の見た目（県パス） ===== */
  /* 県パス（data-code が付くもの）をベース色で塗る。 */
  .stage svg path[data-code]{ fill:var(--y) !important; stroke:#0b132b; stroke-width:1.5; vector-effect:non-scaling-stroke; }
  /* 枠線や区切り線は塗らない（太線グループ想定） */
  .stage svg g[stroke-width="2"] > path{ fill:none !important; }
  /* ホバー時の簡易ハイライト */
  .stage svg path[data-code].hovered{ filter:brightness(1.1); stroke-width:2.2; }

  /* モバイル余白 */
  @media (max-width:480px){ .wrap{ padding:18px 12px 28px; } }
</style>
</head>
<body>
  <div class="wrap">
    <h1>全国ぼぼマップ（仮置き版）</h1>
    <p class="lead">「展示しておく」ことが目的の軽量版。細かい作り込みは後日QSY予定です。</p>
    <span class="pill">置場っ子ちゃんの片隅コーナー</span>

    <div id="stage" class="stage" aria-busy="true" aria-live="polite">
      <!-- ここに SVG をインライン挿入 -->
    </div>

    <p class="note">※ 県パス（<code>path[data-code]</code>）へツールチップ（県名）を自動付与。ホバーでちょい強調。</p>
  </div>

<script>
/* ===== 県コード → 県名 ===== */
const PREF_NAME = {
  "01":"北海道","02":"青森","03":"岩手","04":"秋田","05":"宮城","06":"山形","07":"福島",
  "08":"茨城","09":"栃木","10":"群馬","11":"埼玉","12":"千葉","13":"東京","14":"神奈川",
  "15":"新潟","16":"富山","17":"石川","18":"福井","19":"山梨","20":"長野",
  "21":"岐阜","22":"静岡","23":"愛知","24":"三重",
  "25":"滋賀","26":"京都","27":"大阪","28":"兵庫","29":"奈良","30":"和歌山",
  "31":"鳥取","32":"島根","33":"岡山","34":"広島","35":"山口",
  "36":"徳島","37":"香川","38":"愛媛","39":"高知",
  "40":"福岡","41":"佐賀","42":"長崎","43":"熊本","44":"大分","45":"宮崎","46":"鹿児島","47":"沖縄"
};

/* ===== SVG を同一オリジンから読み込み → インライン化 =====
   docs/ が公開ルートなので、相対パス 'images/japan.svg' でOK。
*/
(async function init() {
  const el = document.getElementById('stage');
  try {
    const res = await fetch('images/japan.svg', {cache: 'no-store'});
    if (!res.ok) throw new Error('SVG fetch failed: ' + res.status);
    const svgText = await res.text();

    // そのまま差し込む（同一オリジンなのでスクリプト操作可）
    el.innerHTML = svgText;

    const svg = el.querySelector('svg');
    if (!svg) throw new Error('SVG root not found');

    // 表示調整（保険）：viewBox が無い場合に備えて付与
    if (!svg.hasAttribute('viewBox')) {
      const w = svg.getAttribute('width') || 2090;
      const h = svg.getAttribute('height') || 2600;
      svg.setAttribute('viewBox', `0 0 ${w} ${h}`);
      svg.removeAttribute('width'); svg.removeAttribute('height');
    }
    svg.setAttribute('preserveAspectRatio', 'xMidYMid meet');

    // 県パスへ <title> 追加（ブラウザ標準ツールチップ）
    const prefs = svg.querySelectorAll('path[data-code]');
    prefs.forEach(p => {
      const code = (p.getAttribute('data-code') || '').padStart(2,'0');
      const name = PREF_NAME[code] || `不明(${code})`;

      // 既存 title をクリアして付け直し
      const old = p.querySelector('title');
      if (old) old.remove();
      const t = document.createElementNS('http://www.w3.org/2000/svg','title');
      t.textContent = `${name}（${code}）`;
      p.appendChild(t);

      // 軽いホバー演出
      p.addEventListener('mouseenter', () => p.classList.add('hovered'));
      p.addEventListener('mouseleave', () => p.classList.remove('hovered'));
    });

    el.setAttribute('aria-busy','false');
  } catch (err) {
    el.innerHTML = `<div style="padding:12px;color:#fca5a5">読み込みエラー：${String(err)}</div>`;
    el.setAttribute('aria-busy','false');
  }
})();
</script>
</body>
</html>
